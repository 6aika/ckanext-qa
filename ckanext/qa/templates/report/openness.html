{% if c.options['organization'] == None %}
  <ul>
    <li>{{ _('Datasets given a score') }}: {{ c.data['num_packages_scored'] }} / {{ c.data['num_packages'] }}</li>
    <li>{{ _('Totals') }}
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>{{ _('Score TBC') }}</th>
            {% for n in range(6) %}
              <th>{{ _('Score') }} {{n}}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ c.data['total_score_counts'].get('null', 0) }}</td>
            {% for n in range(6) %}
              <td>{{ c.data['total_score_counts'].get(n|string, 0) }}</td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </li>
  </ul>
  <table class="table table-striped table-bordered table-condensed tablesorter" id="report-table">
    <colgroup>
      <col style="width: 20%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
      <col style="width: 10%" />
    </colgroup>
    <thead>
      <tr>
        <th>{{ _('Publisher') }}</th>
        <th>{{ _('Score TBC')}} </th>
        {% for n in range(6) %}
          <th>{{ _('Score') }} {{n}}</th>
        {% endfor %}
        <th>{{ _('Total stars') }}</th>
        <th>{{ _('Average stars') }}</th>
      </tr>
    </thead>
    <tbody>
      {% for row in c.data['table'] %}
        <tr>
          <td>{{ h.link_to(row['organization_title'], h.report__relative_url_for(organization=row['organization_name'])) }}</td>
          <td>{{ row.get('null', 0) }}</td>
          {% for n in range(6) %}
            <td>{{ row.get(n|string, 0) }}</td>
          {% endfor %}
          <td>{{ row['total_stars'] }}</td>
          <td>{{ row['average_stars'] }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

{% else %}

  <ul>
    <li>{{ _('Average score') }}: {{ c.data['average_stars'] }}</li>
    <li>{{ _('Total stars') }}: {{ c.data['total_stars'] }}</li>
    <li>{{ _('Datasets given a score') }}: {{ c.data['num_packages_scored'] }} / {{ c.data['num_packages'] }}</li>
    <li>{{ _('Score frequencies') }}:
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>{{ _('Score TBC') }}</th>
            {% for n in range(6) %}
              <th>{{ _('Score') }} {{n}}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ c.data['score_counts'].get('null', 0) }}</td>
            {% for n in range(6) %}
              <td>{{ c.data['score_counts'].get(n|string, 0) }}</td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </li>
  </ul>
  <table class="table table-striped table-bordered table-condensed tablesorter" id="report-table">
    <thead>
      <tr>
        <th>{{ _('Dataset') }}</th>
        <th>{{ _('Notes') }}</th>
        {% if c.options['include_sub_organizations'] %}
          <th>{{ _('Publisher') }}</th>
        {% endif %}
        <th>{{ _('Score') }}</th>
        <th>{{ _('Score reason') }}</th>
      </tr>
    </thead>
    <tbody>
      {% for row in c.data['table'] %}
        <tr>
          <td>{{h.link_to(row['dataset_title'], h.url_for(controller='package', action='read', id=row['dataset_name'])) }}</td>
          <td>{{row['dataset_notes'] }}</td>
          {% if c.options['include_sub_organizations'] %}
            <td>{{ h.link_to(row['organization_title'], h.report__relative_url_for(organization=row['organization_name'])) }}</td>
          {% endif %}
          <td>{{ row['openness_score'] }}</td>
          <td class="js-tooltip" title="{{ row['openness_score_reason'] }}">{{ h.truncate(_(row['openness_score_reason']), 150) }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
